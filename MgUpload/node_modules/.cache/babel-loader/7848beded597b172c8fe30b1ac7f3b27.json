{"ast":null,"code":"import _slicedToArray from \"/Users/yaoqingfeng/Downloads/work/\\u901A\\u7528\\u7EC4\\u4EF6/MgUpload/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/yaoqingfeng/Downloads/work/\\u901A\\u7528\\u7EC4\\u4EF6/MgUpload/src/MgUpload/index.js\";\nimport React, { useState, forwardRef, useRef } from \"react\";\nimport \"./index.css\";\nimport { uuids } from '../utils/utils';\n\nfunction MgUpload(props, ref) {\n  var _this = this;\n\n  var fileList = props.fileList,\n      children = props.children,\n      _props$uploadType = props.uploadType,\n      uploadType = _props$uploadType === void 0 ? 'accessory' : _props$uploadType,\n      _props$length = props.length,\n      length = _props$length === void 0 ? 6 : _props$length,\n      _props$multiple = props.multiple,\n      multiple = _props$multiple === void 0 ? false : _props$multiple,\n      _props$accept = props.accept,\n      accept = _props$accept === void 0 ? '' : _props$accept,\n      _props$handleChange = props.handleChange,\n      handleChange = _props$handleChange === void 0 ? function () {} : _props$handleChange,\n      _props$handleRemove = props.handleRemove,\n      handleRemove = _props$handleRemove === void 0 ? function () {} : _props$handleRemove;\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      files = _useState2[0],\n      setFiles = _useState2[1];\n\n  var inputRef = useRef();\n\n  var onChange = function onChange(info) {\n    var fileLists = [];\n    Object.entries(info.currentTarget.files).forEach(function (item) {\n      var _item = _slicedToArray(item, 2),\n          key = _item[0],\n          value = _item[1];\n\n      var file = {\n        uid: uuids(),\n        name: value.name,\n        size: value.size,\n        type: value.type,\n        lastModified: value.lastModified,\n        lastModifiedDate: value.lastModifiedDate,\n        originFileObj: item[1]\n      };\n      fileLists.push(file);\n    });\n\n    if (!fileList) {\n      setFiles(fileLists);\n    }\n\n    handleChange({\n      fileList: fileLists\n    });\n  }; // 移除的回调\n\n\n  var handleDelete = function handleDelete(file) {\n    console.log(file);\n    var newFiles = files.filter(function (item) {\n      return item.uid !== file.uid;\n    });\n\n    if (!fileList) {\n      setFiles(newFiles);\n    }\n\n    handleRemove(file);\n  };\n\n  var newFileList = fileList || files;\n  console.log(newFileList);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    ref: inputRef,\n    style: {\n      display: \"none\"\n    },\n    type: \"file\",\n    accept: accept,\n    multiple: multiple,\n    files: newFileList,\n    onChange: onChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }\n  }), uploadType === 'accessory' ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload-accessory\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 37\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    className: \"mg-upload-button\",\n    onClick: function onClick() {\n      inputRef.current.click();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }, children || /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload-button-content\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 24\n    }\n  }, /*#__PURE__*/React.createElement(\"span\", {\n    className: \"mg-upload-button-content-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }), \"\\u9009\\u62E9\\u6587\\u4EF6\")), newFileList.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mg-upload-accessory-item\",\n      key: item.uid,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 34\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      style: {\n        display: 'flex',\n        alignItems: 'center'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mg-upload-accessory-item-icon mg-upload-accessory-icon\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 13\n      }\n    }), item.name), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mg-upload-accessory-item-icon mg-upload-delete-icon\",\n      onClick: function onClick() {\n        return handleDelete(item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 11\n      }\n    }));\n  })) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload-picture\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  }, newFileList.map(function (item) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: item.uid,\n      className: \"mg-upload-picture-content\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 37\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mg-upload-picture-content-shade\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"mg-upload-picture-content-icon\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mg-upload-picture-content-icon-view\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 19\n      }\n    }), /*#__PURE__*/React.createElement(\"span\", {\n      className: \"mg-upload-picture-content-icon-delete\",\n      onClick: function onClick() {\n        return handleDelete(item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87,\n        columnNumber: 19\n      }\n    }))), /*#__PURE__*/React.createElement(\"img\", {\n      style: {\n        width: '100%',\n        height: '100%'\n      },\n      key: item.uid,\n      src: item.url || window.URL.createObjectURL(item.originFileObj),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 15\n      }\n    }));\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload-picture-select\",\n    style: {\n      display: newFileList.length > length ? 'none' : 'flex'\n    },\n    onClick: function onClick() {\n      inputRef.current.click();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload-picture-select-content-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mg-upload-picture-select-content-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }\n  }, \"\\u9009\\u62E9\\u56FE\\u7247\"))));\n}\n\nexport default forwardRef(MgUpload);","map":{"version":3,"sources":["/Users/yaoqingfeng/Downloads/work/通用组件/MgUpload/src/MgUpload/index.js"],"names":["React","useState","forwardRef","useRef","uuids","MgUpload","props","ref","fileList","children","uploadType","length","multiple","accept","handleChange","handleRemove","files","setFiles","inputRef","onChange","info","fileLists","Object","entries","currentTarget","forEach","item","key","value","file","uid","name","size","type","lastModified","lastModifiedDate","originFileObj","push","handleDelete","console","log","newFiles","filter","newFileList","display","current","click","map","alignItems","width","height","url","window","URL","createObjectURL"],"mappings":"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","sourcesContent":["import React, { useState, forwardRef, useRef } from \"react\";\nimport \"./index.css\";\nimport { uuids } from '../utils/utils'\n\nfunction MgUpload(props, ref) {\n  const {\n    fileList,\n    children,\n    uploadType = 'accessory',\n    length = 6,\n    multiple = false,\n    accept = '',\n    handleChange = () => { },\n    handleRemove = () => { },\n  } = props\n  const [files, setFiles] = useState([]);\n  const inputRef = useRef();\n\n  const onChange = (info) => {\n    const fileLists = [];\n    Object.entries(info.currentTarget.files).forEach(item => {\n      const [key, value] = item;\n      const file = {\n        uid: uuids(),\n        name: value.name,\n        size: value.size,\n        type: value.type,\n        lastModified: value.lastModified,\n        lastModifiedDate: value.lastModifiedDate,\n        originFileObj: item[1]\n      };\n      fileLists.push(file);\n    });\n    if (!fileList) {\n      setFiles(fileLists)\n    }\n    handleChange({ fileList: fileLists });\n  };\n\n  // 移除的回调\n  const handleDelete = (file) => {\n    console.log(file)\n    const newFiles = files.filter(item => item.uid !== file.uid)\n    if (!fileList) {\n      setFiles(newFiles)\n    }\n    handleRemove(file)\n  }\n\n  const newFileList = fileList || files;\n  console.log(newFileList)\n  return (\n    <div className='mg-upload'>\n      <input\n        ref={inputRef}\n        style={{ display: \"none\" }}\n        type=\"file\"\n        accept={accept}\n        multiple={multiple}\n        files={newFileList}\n        onChange={onChange}\n      />\n      {uploadType === 'accessory' ? <div className='mg-upload-accessory'>\n        <button className='mg-upload-button' onClick={() => { inputRef.current.click() }}>\n          {children || <div className='mg-upload-button-content'>\n            <span className='mg-upload-button-content-icon'></span>选择文件\n          </div>\n          }\n        </button>\n        {newFileList.map(item => <div className='mg-upload-accessory-item' key={item.uid}>\n          <span style={{ display: 'flex', alignItems: 'center' }}>\n            <span className='mg-upload-accessory-item-icon mg-upload-accessory-icon'></span>{item.name}\n          </span>\n          <span\n            className='mg-upload-accessory-item-icon mg-upload-delete-icon'\n            onClick={() => handleDelete(item)}\n          ></span>\n        </div>)}\n      </div>\n        :\n        <div className='mg-upload-picture' >\n          {\n            newFileList.map(item => <div key={item.uid} className='mg-upload-picture-content'>\n              <div className='mg-upload-picture-content-shade'>\n                <div className='mg-upload-picture-content-icon'>\n                  <span className='mg-upload-picture-content-icon-view' />\n                  <span className='mg-upload-picture-content-icon-delete' onClick={() => handleDelete(item)} />\n                </div>\n              </div>\n              <img style={{ width: '100%', height: '100%' }} key={item.uid} src={item.url || window.URL.createObjectURL(item.originFileObj)} />\n            </div>)\n          }\n          <div\n            className='mg-upload-picture-select'\n            style={{ display: newFileList.length > length ? 'none' : 'flex' }}\n            onClick={() => { inputRef.current.click() }}\n          >\n            <div className='mg-upload-picture-select-content-icon'></div>\n            <div className='mg-upload-picture-select-content-text'>选择图片</div>\n          </div>\n        </div>\n      }\n    </div>\n  );\n}\n\nexport default forwardRef(MgUpload);\n"]},"metadata":{},"sourceType":"module"}